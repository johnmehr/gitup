.\" Copyright (c) 2012-2020, John Mehr <jmehr@umn.edu>
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\" $FreeBSD$
.\"
.Dd December 5, 2020
.Dt GITUP
.Os
.Sh NAME
.Nm gitup
.Nd A minimalist, dependency-free program to clone/pull Git repositories.
.Sh SYNOPSIS
.Nm
.Cm section
.Op Fl ckrV
.Op Fl h Ar commit checksum
.Op Fl t Ar tag
.Op Fl u Ar pack file
.Op Fl v Ar verbosity
.Op Fl w Ar commit checksum
.Sh DESCRIPTION
.Nm
is a minimalist, dependency-free program used to clone or synchronize a local
copy of a Git repository.
It is not intended to be a full-featured replacement for the devel/git port,
but rather, is intended to provide a convenient way for users to update FreeBSD
source files without having to install devel/git (and all of its related
dependencies) and without the substantial disk overhead that normally accompany
local Git repositories.
.Pp
.Nm
currently only supports anonymous, encrypted transfers via the "Smart HTTP"
protocol.
.Sh OPTIONS
Configuration options are stored in %%CONFIG_FILE_PATH%% and are grouped
into commonly used sections (additional custom sections can be added to this
file).
The following command line options can be used to override the default and/or
section values:
.Bl -tag -width Fl
.It Fl c
Force
.Nm
to clone the repository.
.It Fl h
The "have" commit checksum of the repository to use.
Only needed when importing a pack file generated by the official Git client.
.It Fl k
Save a copy of the pack data.
.It Fl r
Repair the local repository, replacing any files that are missing or have been
modified.
.It Fl t
Fetch the commit referenced by the specified tag.
.It Fl u
Skip the download of the pack data and use the specified file instead.
.It Fl v
How verbose the output should be (0 = no output, 1 = show only names of the
updated files, 2 = also show commands sent to the server and additional
debugging information).
.It Fl V
Display the version number and exit.
.It Fl w
The "want" commit checksum of the repository to retrieve.
.El
.Sh FILES
.Bl -tag -width "%%CONFIG_FILE_PATH%%"
.It %%CONFIG_FILE_PATH%%
Default location of the
.Nm
configuration file.
.It /var/db/gitup
Default location where
.Nm
stores its lists of known files.
The files stored here are used during subsequent runs to reconstruct the local
repository state and confirm that the local tree is intact.
.El
.Sh CAVEATS
Because
.Nm
neither uses nor updates the .git directory, it is not a drop-in replacement for
the official Git client.
.Nm
should only be used on repositories originally cloned with the official Git
client if there is no intention to ever use the official Git client on that
local repository again.
.Pp
To keep its footprint as small as possible,
.Nm
does not retain pack files downloaded from the repository (unless explicitly
instructed to do so) and does not use a saved pack file (unless explicitly
instructed to do so).
.Nm
relies on the known remote files lists stored in /var/db/gitup and the current
state of the local repository to reconstruct data that would normally be stored
in the pack file.
Discrepancies in the local repository will be flagged as errors and
.Nm
will attempt to any restore any missing or modified files from the server,
returning the local repository to a clean state.
.Sh EXAMPLES
Using the configuration options for commonly used repositories/branches stored
in %%CONFIG_FILE_PATH%%, to clone/pull a copy of the most recent revision
of stable/12:
.Pp
.Dl "gitup stable"
.Pp
To retrieve a copy of freebsd-ports at
commit 0123456789abcdef0123456789abcdef01234567:
.Pp
.Dl "gitup ports -w 0123456789abcdef0123456789abcdef01234567"
.Sh SEE ALSO
.Xr gitup.conf 5
.Sh AUTHORS
John Mehr <jmehr@umn.edu> is the author of
.Nm
and this man page.
